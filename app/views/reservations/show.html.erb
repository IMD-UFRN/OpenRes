<h1>Detalhes da Reserva</h1>

<%= @reservation.edit_link %>
<%= @reservation.approve_link %>
<%= @reservation.suspend_link %>
<%= @reservation.reject_link %>
<%= @reservation.cancel_link %>

<hr>

<dl>
  <dt>Situação:</dt> <dd><%= @reservation.status %></dd>
  <dt>Data:</dt> <dd><%= @reservation.date %></dd>
  <dt>Solicitante:</dt> <dd><%= @reservation.user %></dd>
  <dt>Início:</dt> <dd><%= @reservation.begin_time %></dd>
  <dt>Término:</dt> <dd><%= @reservation.end_time %></dd>
  <dt>Solicitada em:</dt> <dd><%= @reservation.created_at %></dd>
  <dt>Sala:</dt> <dd><%= link_to @reservation.place %></dd>
  <dt>Tipo de Sala:</dt> <dd><%= link_to @reservation.room_type%></dd>
  <dt>Setor Responsável:</dt> <dd><% @reservation.sectors.each do |sector| %><%= link_to sector.name, sector_path(sector) %><%end%></dd>
  <dt>Motivo:</dt> <dd><%= @reservation.reason %></dd>
  <dt>Autorizado:</dt> <dd><%= @reservation.responsible %></dd>
</dl>



<hr>

<h2 id="conflicts">Reservas que conflitam com esta</h2>

<table class="table table-striped table-bordered table-hover">
  <thead>
    <tr>
      <th>Data</th>
      <th>Início</th>
      <th>Fim</th>
      <th>Motivo</th>
      <th>Ações</th>
    </tr>
  </thead>

  <tbody>
    <% unless @conflicts.length == 0 %>
      <% @conflicts.each do |reservation| %>
        <tr>
          <td><%= reservation.date %></td>
          <td><%= reservation.begin_time %></td>
          <td><%= reservation.end_time %></td>
          <td><%= reservation.reason %></td>
          <td><%= reservation.details_link %></td>

        </tr>
      <% end %>
    <%else%>
      <tr>
        <td colspan="5">Não existem reservam que conflitam horários com esta.</td>
      </tr>
    <% end %>
  </tbody>
</table>

<hr>

<h2>Histórico da Reserva</h2>
<!--ADICIONAR COLUNA DE MUDANÇAS NA MIGRATION ANTIGA CONFORME: https://github.com/airblade/paper_trail#diffing-versions-->
<div class="panel">
  <div class="panel-heading">
    Data de Modificação
  </div>
  <div class="panel-body">
    <% unless @reservation.versions.length == 0 %>
      <% @reservation.versions.each do |v| %>
        <%= v.reify.updated_at.strftime("%d/%m/%Y - %H:%M") %>
        <%= v.changeset.inspect %> <br>
      <% end %>
    <% end %>
  </div>

</div>




<%= @reservation.versions[0].inspect %>

<div id="modal-window" class="modal hide fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"></div>
